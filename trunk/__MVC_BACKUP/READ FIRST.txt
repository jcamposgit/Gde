=================================================================
------------ Club Starter Kit v3 Beta 2 Install Docs ------------
=================================================================

--- STEP 0 ---
First of all, thank you for opening this document. The fact that you follow 
instructions is really a great skill to have in life :)

--- STEP 1 ---
Make sure you have Visual Studio 2010 Beta 2 installed. This will not run
with Visual Studio 2008 or Visual Studio 2010 Beta 1. 

--- STEP 2 ---
Create a database, preferably a SQL 2008 database, using SQL or SQL express

--- STEP 3 ---
Next, to set your connection string, pop open the Web.config and search for 
the connection string. It should be named csk. Change it to your whim. This 
connection should be optimized for SQL Server 2008. If you are using another 
DB server (like SQL 2005) you will need to do the following:
	
	- Open SessionBuilder.cs file in the web project's Infrastructure/Application folder
	
	- Override the DataConfiguration provider like this (example for SQL 2005)
		public override FluentNHibernate.Cfg.Db.IPersistenceConfigurer DataConfiguration
		{
			get
			{
				return FluentNHibernate.Cfg.Db.MsSqlConfiguration
											  .MsSql2005
											  .ConnectionString(ConnectionString);
			}
		}

But trust me... just use SQL 2008. They have a really cool new type called 
DateTimeOffset that works well for those globalized apps. 

--- STEP 4 ---
To setup your database, open the Global.asax file in the web project uncomment line 42
that reads

new ClubStarterKit.Data.NHibernate.NHDataProvider(new ClubStarterKit.Web.Infrastructure.Application.SessionBuilder()).Hydrate();

Run your application. After the website loads, close the browser and delete
line 42 in the Global.asax file. At this point, your database
should contain the tables necessary for Club Starter Kit.

--- STEP 5 ---
Next thing you want to do is add an admin user. To do so, open up the website
and go through the user registration process. Then open Global.asax class again and 
insert the following code, replacing [username] with the username you entered,
into the Application_Start method.

	using (var scope = new ClubStarterKit.Core.DataAccess.UnitOfWorkScope())
	{
		var role = new ClubStarterKit.Domain.Role
		{
			RoleName = Constants.AdminRole
		};
		scope.UnitOfWork.RepositoryFor<ClubStarterKit.Domain.Role>().Save(role);
		scope.Commit();
	}

	using (var scope = new ClubStarterKit.Core.DataAccess.UnitOfWorkScope())
	{
		var user = scope.UnitOfWork.RepositoryFor<ClubStarterKit.Domain.User>()
								   .First(u => u.Username == "[username]");
		var role = scope.UnitOfWork.RepositoryFor<ClubStarterKit.Domain.User>()
								   .First(r => r.RoleName == Constants.AdminRole);

		var userinrole = new ClubStarterKit.Domain.UserInRole
		{
			User = user,
			Role = role
		};		
		scope.UnitOfWork.RepositoryFor<ClubStarterKit.Domain.UserInRole>().Save(userinrole);

		scope.Commit();
	}
	
Now run the website and close it after it loads. Then delete the code added
to the Application_Start.

--- STEP 5 ---
Next thing you should do is configure the settings. Open the Web.Config and locate the appSettings
section at the top of the screen. Now edit the "values". Do not alter the keys. 

------------ Known Issues ------------
- Photo deletion doesn't work
- NHibernate repository "delete" is buggy

Happy developing!